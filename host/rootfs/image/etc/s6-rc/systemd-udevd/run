#!/bin/execlineb -P
# SPDX-License-Identifier: EUPL-1.2+
# SPDX-FileCopyrightText: 2025 Demi Marie Obenour <demiobenour@gmail.com>
if { mkdir -p /run/sd-notify-wrapper }
s6-setlock -d 4 /run/sd-notify-wrapper/systemd-udevd.lock
if { rm -f /run/sd-notify-wrapper/systemd-udevd.sock }
background {
   s6-ipcserver-socketbinder -b0 -m -a 0600 /run/sd-notify-wrapper/systemd-udevd.sock
   fdmove 1 3
   sd-notify-adapter
}
fdclose 3
export NOTIFY_SOCKET /run/sd-notify-wrapper/systemd-udevd.sock
exec -a systemd-udevd udevadm
