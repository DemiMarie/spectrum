#!/bin/execlineb -P
# SPDX-License-Identifier: EUPL-1.2
# SPDX-FileCopyrightText: 2020-2021 Alyssa Ross <hi@alyssa.is>

/bin/export PATH /bin
/bin/s6-setsid -qb --

umask 022
if { mount -t tmpfs -o mode=0755 tmpfs /run }
if { s6-hiercopy /etc/service /run/service }
emptyenv -p

background {
  s6-setsid --

  if { s6-rc-init -c /etc/s6-rc /run/service }

  if { s6-mkdir -p /dev/pts /dev/shm }

  if { mount -a }

  s6-rc change ok-all
}

unexport !
cd /run/service
s6-svscan
